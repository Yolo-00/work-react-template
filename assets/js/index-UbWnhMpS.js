import{r as s,y as n,j as e,M as f,I as w,T as b,K as C,N as y,S as j,P as Y,o as h,Q as k}from"./vendor-BVX_8YO6.js";function L({onSaveData:c},a){const[u,l]=s.useState(!1),[i,m]=s.useState(void 0),[d]=n.useForm();s.useImperativeHandle(a,()=>({showModal:(x,p)=>{l(!0),m(p),d.resetFields(),x&&d.setFieldsValue(x)}}),[d]);const g=s.useCallback(()=>{d.validateFields().then(()=>{l(!1),c(d.getFieldsValue(),i)})},[d,i,c]);return e.jsx(e.Fragment,{children:e.jsx(f,{title:i!==void 0?"编辑":"新增",open:u,onOk:g,onCancel:()=>l(!1),children:e.jsxs(n,{form:d,name:"saveUser",children:[e.jsx(n.Item,{label:"姓名",name:"name",rules:[{required:!0,message:"请输入姓名"}],children:e.jsx(w,{placeholder:"请输入姓名",allowClear:!0})}),e.jsx(n.Item,{label:"年龄",name:"age",rules:[{required:!0,message:"请输入年龄"}],children:e.jsx(b,{className:"w-full",controls:!1,placeholder:"请输入年龄",max:200,min:0})}),e.jsx(n.Item,{label:"性别",name:"sex",rules:[{required:!0,message:"请输入性别"}],children:e.jsx(C,{placeholder:"请输入性别",allowClear:!0,showSearch:!0,optionFilterProp:"label",defaultActiveFirstOption:!1,options:[{label:"男",value:1},{label:"女",value:2}]})}),e.jsx(n.Item,{label:"地址",name:"address",rules:[{required:!0,message:"请输入地址"}],children:e.jsx(w.TextArea,{placeholder:"请输入地址",allowClear:!0,count:{max:200,show:!0}})})]})})})}const R=s.forwardRef(L),q=[{key:"1",name:"胡彦斌",age:32,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"},{key:"2",name:"胡彦祖1",age:42,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"},{key:"3",name:"胡彦祖2",age:42,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"},{key:"4",name:"胡彦祖3",age:42,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"},{key:"5",name:"胡彦祖4",age:42,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"}],z=[{title:"姓名",dataIndex:"name",key:"name"},{title:"年龄",dataIndex:"age",key:"age",width:80,sorter:(c,a)=>c.age-a.age},{title:"性别",dataIndex:"sex",key:"sex",render:(c,a)=>a.sex===1?"男":"女"},{title:"住址",dataIndex:"address",key:"address"},{title:"创建时间",dataIndex:"createTime",key:"createTime"}];function _(){const[c]=n.useForm(),[a,u]=s.useState([]),[l,i]=s.useState({current:1,pageSize:5,total:a.length}),[m,d]=s.useState([]),[g,x]=s.useState(!0),p=s.useRef(null),S=()=>{c.getFieldsValue(),x(!0)},v=()=>{c.resetFields()},I=t=>{i({current:t.current,pageSize:t.pageSize,total:t.total})},T=s.useCallback(t=>{f.confirm({centered:!0,destroyOnClose:!0,title:"提示",content:"是否确认删除?",onOk:()=>{const r=[...a];r.splice(t,1),u(r),i({...l,total:l.total-1})}})},[a,l]),F=s.useCallback(()=>{if(m.length===0){f.warning({centered:!0,destroyOnClose:!0,title:"提示",content:"请选择数据"});return}f.confirm({centered:!0,destroyOnClose:!0,title:"提示",content:"是否确认删除?",onOk:()=>{u(a.filter(t=>!m.includes(t.key))),i({...l,total:l.total-m.length})}})},[a,m,l]),D=()=>{var t;(t=p.current)==null||t.showModal()},M=(t,r)=>{var o;(o=p.current)==null||o.showModal(t,r)},O=s.useCallback((t,r)=>{if(r!==void 0){const o=[...a];o[r]={...t,createTime:o[r].createTime,key:o[r].key},u(o)}else u([{...t,createTime:y().format("YYYY-MM-DD HH:mm:ss"),key:a.length>0?a[a.length-1].key+1:1},...a]),i({...l,total:l.total+1})},[a,l]),N=t=>{d(t)};return s.useEffect(()=>{setTimeout(()=>{x(!1),u([...q])},1e3)},[g]),e.jsx(e.Fragment,{children:e.jsxs(j,{direction:"vertical",size:"large",className:"w-full",children:[e.jsxs(n,{form:c,name:"query",layout:"inline",style:{rowGap:"10px"},children:[e.jsx(n.Item,{label:"姓名",name:"name",children:e.jsx(w,{className:"w-48",placeholder:"请输入姓名",allowClear:!0})}),e.jsx(n.Item,{label:"年龄",name:"age",children:e.jsx(b,{className:"w-48",controls:!1,placeholder:"请输入年龄",max:200,min:0})}),e.jsx(n.Item,{label:"性别",name:"sex",children:e.jsx(C,{className:"w-48",placeholder:"请输入性别",allowClear:!0,showSearch:!0,optionFilterProp:"label",defaultActiveFirstOption:!1,options:[{label:"男",value:1},{label:"女",value:2}]})}),e.jsx(n.Item,{label:"时间",name:"time",getValueFromEvent:(t,r)=>r,getValueProps:t=>({value:t&&y(t)}),children:e.jsx(Y,{className:"w-48",presets:[{label:"前一天",value:y().add(-1,"d")},{label:"前一周",value:y().add(-7,"d")},{label:"前一月",value:y().add(-1,"month")}],placeholder:"请选择时间",format:"YYYY-MM-DD HH:mm:ss",showTime:!0})}),e.jsx(n.Item,{children:e.jsxs(j,{wrap:!0,size:"middle",children:[e.jsx(h,{type:"primary",onClick:S,children:"搜索"}),e.jsx(h,{onClick:v,children:"重置"})]})})]}),e.jsxs(j,{children:[e.jsx(h,{type:"primary",onClick:D,children:"创建"}),e.jsx(h,{type:"primary",danger:!0,onClick:F,children:"批量删除"})]}),e.jsxs(k,{dataSource:a,bordered:!0,sticky:!0,loading:g,tableLayout:"auto",pagination:{showQuickJumper:!0,showTotal:t=>`共 ${t} 条`,...l},rowSelection:{type:"checkbox",onChange:N},onChange:I,children:[e.jsx(k.Column,{title:"索引",dataIndex:"index",render:(t,r,o)=>o+1},"index"),z.map(t=>s.createElement(k.Column,{...t,key:t.key})),e.jsx(k.Column,{title:"操作",dataIndex:"operation",render:(t,r,o)=>e.jsxs(j,{size:"large",children:[e.jsx(h,{type:"primary",onClick:()=>M(r,o),children:"编辑"}),e.jsx(h,{type:"primary",danger:!0,onClick:()=>T(o),children:"删除"})]})},"operation")]}),e.jsx(R,{ref:p,onSaveData:O})]})})}export{_ as default};
