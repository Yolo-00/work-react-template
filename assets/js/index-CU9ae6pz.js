import{r as l,F as r,j as e,M as k,I as w,T as b,G as S,S as j,J as y,K as Y,B as m,N as f}from"./vendor-DOalDL_i.js";function L({onSaveData:d},a){const[c,o]=l.useState(!1),[i,h]=l.useState(void 0),[u]=r.useForm();l.useImperativeHandle(a,()=>({showModal:(x,p)=>{o(!0),h(p),u.resetFields(),x&&u.setFieldsValue(x)}}));const g=()=>{u.validateFields().then(()=>{o(!1),d(u.getFieldsValue(),i)})};return e.jsx(e.Fragment,{children:e.jsx(k,{title:i!==void 0?"编辑":"新增",open:c,onOk:g,onCancel:()=>o(!1),children:e.jsxs(r,{form:u,name:"saveUser",children:[e.jsx(r.Item,{label:"姓名",name:"name",rules:[{required:!0,message:"请输入姓名"}],children:e.jsx(w,{placeholder:"请输入姓名",allowClear:!0})}),e.jsx(r.Item,{label:"年龄",name:"age",rules:[{required:!0,message:"请输入年龄"}],children:e.jsx(b,{className:"w-full",controls:!1,placeholder:"请输入年龄",max:200,min:0})}),e.jsx(r.Item,{label:"性别",name:"sex",rules:[{required:!0,message:"请输入性别"}],children:e.jsx(S,{placeholder:"请输入性别",allowClear:!0,showSearch:!0,optionFilterProp:"label",defaultActiveFirstOption:!1,options:[{label:"男",value:1},{label:"女",value:2}]})}),e.jsx(r.Item,{label:"地址",name:"address",rules:[{required:!0,message:"请输入地址"}],children:e.jsx(w.TextArea,{placeholder:"请输入地址",allowClear:!0,count:{max:200,show:!0}})})]})})})}const R=l.forwardRef(L),q=[{key:"1",name:"胡彦斌",age:32,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"},{key:"2",name:"胡彦祖1",age:42,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"},{key:"3",name:"胡彦祖2",age:42,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"},{key:"4",name:"胡彦祖3",age:42,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"},{key:"5",name:"胡彦祖4",age:42,address:"西湖区湖底公园1号",sex:1,createTime:"2022-01-01 00:00:00"}],z=[{title:"姓名",dataIndex:"name",key:"name"},{title:"年龄",dataIndex:"age",key:"age",width:80,sorter:(d,a)=>d.age-a.age},{title:"性别",dataIndex:"sex",key:"sex",render:(d,a)=>a.sex===1?"男":"女"},{title:"住址",dataIndex:"address",key:"address"},{title:"创建时间",dataIndex:"createTime",key:"createTime"}];function _(){const[d]=r.useForm(),[a,c]=l.useState([]),[o,i]=l.useState({current:1,pageSize:5,total:a.length}),[h,u]=l.useState([]),[g,x]=l.useState(!0),p=l.useRef(null),C=l.useCallback(()=>{d.getFieldsValue(),x(!0)},[d]),v=l.useCallback(()=>{d.resetFields()},[d]),I=t=>{i({current:t.current,pageSize:t.pageSize,total:t.total})},T=t=>{k.confirm({centered:!0,destroyOnClose:!0,title:"提示",content:"是否确认删除?",onOk:()=>{const s=[...a];s.splice(t,1),c(s),i({...o,total:o.total-1})}})},F=()=>{if(h.length===0){k.warning({centered:!0,destroyOnClose:!0,title:"提示",content:"请选择数据"});return}k.confirm({centered:!0,destroyOnClose:!0,title:"提示",content:"是否确认删除?",onOk:()=>{c(a.filter(t=>!h.includes(t.key))),i({...o,total:o.total-h.length})}})},D=()=>{var t;(t=p.current)==null||t.showModal()},M=(t,s)=>{var n;(n=p.current)==null||n.showModal(t,s)},O=(t,s)=>{if(s!==void 0){const n=[...a];n[s]={...t,createTime:n[s].createTime,key:n[s].key},c(n)}else c([{...t,createTime:y().format("YYYY-MM-DD HH:mm:ss"),key:a.length>0?a[a.length-1].key+1:1},...a]),i({...o,total:o.total+1})},N=t=>{u(t)};return l.useEffect(()=>{setTimeout(()=>{x(!1),c([...q])},1e3)},[g]),e.jsx(e.Fragment,{children:e.jsxs(j,{direction:"vertical",size:"large",className:"w-full",children:[e.jsxs(r,{form:d,name:"query",layout:"inline",style:{rowGap:"10px"},children:[e.jsx(r.Item,{label:"姓名",name:"name",children:e.jsx(w,{className:"w-48",placeholder:"请输入姓名",allowClear:!0})}),e.jsx(r.Item,{label:"年龄",name:"age",children:e.jsx(b,{className:"w-48",controls:!1,placeholder:"请输入年龄",max:200,min:0})}),e.jsx(r.Item,{label:"性别",name:"sex",children:e.jsx(S,{className:"w-48",placeholder:"请输入性别",allowClear:!0,showSearch:!0,optionFilterProp:"label",defaultActiveFirstOption:!1,options:[{label:"男",value:1},{label:"女",value:2}]})}),e.jsx(r.Item,{label:"时间",name:"time",getValueFromEvent:(t,s)=>s,getValueProps:t=>({value:t&&y(t)}),children:e.jsx(Y,{className:"w-48",presets:[{label:"前一天",value:y().add(-1,"d")},{label:"前一周",value:y().add(-7,"d")},{label:"前一月",value:y().add(-1,"month")}],placeholder:"请选择时间",format:"YYYY-MM-DD HH:mm:ss",showTime:!0})}),e.jsx(r.Item,{children:e.jsxs(j,{wrap:!0,size:"middle",children:[e.jsx(m,{type:"primary",onClick:C,children:"搜索"}),e.jsx(m,{onClick:v,children:"重置"})]})})]}),e.jsxs(j,{children:[e.jsx(m,{type:"primary",onClick:D,children:"创建"}),e.jsx(m,{type:"primary",danger:!0,onClick:F,children:"批量删除"})]}),e.jsxs(f,{dataSource:a,bordered:!0,sticky:!0,loading:g,tableLayout:"auto",pagination:{showQuickJumper:!0,showTotal:t=>`共 ${t} 条`,...o},rowSelection:{type:"checkbox",onChange:N},onChange:I,children:[e.jsx(f.Column,{title:"索引",dataIndex:"index",render:(t,s,n)=>n+1},"index"),z.map(t=>l.createElement(f.Column,{...t,key:t.key})),e.jsx(f.Column,{title:"操作",dataIndex:"operation",render:(t,s,n)=>e.jsxs(j,{size:"large",children:[e.jsx(m,{type:"primary",onClick:()=>M(s,n),children:"编辑"}),e.jsx(m,{type:"primary",danger:!0,onClick:()=>T(n),children:"删除"})]})},"operation")]}),e.jsx(R,{ref:p,onSaveData:O})]})})}export{_ as default};
